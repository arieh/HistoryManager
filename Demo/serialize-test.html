<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
	<title>History-Manager Demo</title>
	<meta http-equiv="Content-Type" content="text/html; charset='UTF-8'" />
</head>
<body>
<ul>
	<li><a href='javascript:;' id='step'>Click To Step</a></li>
</ul>
<ul id='result'></ul>
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/mootools/1.2.4/mootools-yui-compressed.js'></script>
<script type="text/javascript" src="mootools-1.2.4.4-more.js"></script>
<script type='text/javascript' src='../Source/HashListener.js'></script>
<script type='text/javascript' src='../Source/HistoryManager.js'></script>
<script type='text/javascript'>
	var i=0, 
		HM = new HistoryManager({
			'delimiter':'!'
			, serialize:function(obj){
				return obj.toQueryString();
			}
			, desserialize:function(hash){
				return new Hash(hash.parseQueryString());
			}
		}), 
		res = $('result')
		, testValues = [
			['select','L1']
			,['b','hide']
			,['select','L1;L2']
			,['b','hide']
		];
	
	$('step').addEvent('click',function(){
		var value = testValues[i++];
		HM.set(value[0],value[1]);
		if (i==4) i=0;
	});
	
	function updateSelect(value){
		res.adopt(new Element('li',{'html':'select: '+value}));
	}
	
	function updateB(value){
		res.adopt(new Element('li',{'html':'b: '+value}));
	}
	
	HM.addEvents({
		 'select-changed' :updateSelect
		, 'b-changed' :updateB
		,'select-added' :updateSelect
		, 'b-added' :updateB
	});
	
	HM.start();
	
</script>
</body>
</html>
